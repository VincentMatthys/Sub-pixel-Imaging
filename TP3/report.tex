\documentclass[12pt,a4paper,onecolumn]{article}
\input{packages}
\input{macros}

% ------------------------ General informations --------------------------------
\title{Matrice Fondamentale}
\author{Vincent Matthys}
\graphicspath{{images/}}
% ------------------------------------------------------------------------------


\begin{document}

\begin{tabularx}{0.9\textwidth}{@{} l X r @{} }
	{\textsc{Master MVA}}               &  & \textsc{TP2}       \\
	\textsc{Sub-pixel image processing} &  & {ENS Paris Saclay} \\
\end{tabularx}
\vspace{1.5cm}
\begin{center}

	\rule[11pt]{5cm}{0.5pt}

	\textbf{\LARGE \textsc{Compte-rendu TP3}}
	\vspace{0.5cm}

	Vincent Matthys

	vincent.matthys@ens-paris-saclay.fr

	\rule{5cm}{0.5pt}

	\vspace{1.5cm}
\end{center}

\section{Exercice 6}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.25\textheight]{6_5}
		\subcaption{Pour \(N = 5\)}
		\label{fig_6_5}
	\end{subfigure}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.25\textheight]{6_10}
		\subcaption{Pour \(N = 10\)}
		\label{fig_6_10}
	\end{subfigure}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.25\textheight]{6_50}
		\subcaption{Pour \(N = 50\)}
		\label{fig_6_50}
	\end{subfigure}
	\caption{Représentation graphique de la convergence du \(sincd_N\) et du \(sinc\), sur \([-N/2, N/2]\)}
	\label{fig_6}
\end{figure}

En figure~\ref{fig_6} sont représentés le \(sinc\) et le \(sincd_N\), pour différentes valeurs de \(N\) pour \(x \in[-N/2, N/2]\). On constate que, pour chaque valeur entière, on a bien égalité, et que, pour N assez grand, les différences sont minimes.

\section{Exercice 7}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\begin{lstlisting}[frame = none, numbers = none]
		u = double(imread('lena.pgm'));
		\end{lstlisting}
		\includegraphics[scale = 1, height = 0.3\textheight]{lena.png}
		\subcaption{Image lena}
	\end{subfigure}
	\vspace{2cm}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\begin{lstlisting}[frame=none, numbers = none]
		f = fft2(u);
		imshow(f, 'InitialMagnification', 100);
		\end{lstlisting}
		\includegraphics[scale = 1, height = 0.3\textheight]{7_1}
		\subcaption{Partie réelle de la transformée de Fourier de lena}
	\end{subfigure}
	\caption{Partie réelle de la transformée de Fourier de Lena}
	\label{7_1}
\end{figure}

En figure~\ref{7_1}, on demande à Matlab d'afficher en niveaux de gris une matrice complexe, résultant en un message d'erreur \textit{Warning: Displaying real part of complex input.}. On observe donc uniquement la partie réelle de la transformée de Fourier.

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\begin{lstlisting}[frame = none, numbers = none]
		imshow(abs(f));
		\end{lstlisting}
		\includegraphics[scale = 1, height = 0.3\textheight]{7_21}
		\subcaption{Sans l'option [] de imshow}
		\label{7_21}
	\end{subfigure}
	\vspace{2cm}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\begin{lstlisting}[frame=none, numbers = none]
		imshow(abs(f),[]);
		\end{lstlisting}
		\includegraphics[scale = 1, height = 0.3\textheight]{7_22}
		\subcaption{Avec l'option [ ] de imshow}
		\label{7_22}
	\end{subfigure}
	\caption{Représentations du module de la transformée de Fourier}
	\label{7_2}
\end{figure}

En figure~\ref{7_2}, la commande~\ref{7_21} est équivalent à :
\begin{lstlisting}[numbers = none]
imshow(abs(f) > 1);
\end{lstlisting}
et on n'obtient que des pixels blancs, puisque imshow, quand on lui présente un double (ce qui est le type de abs(f)), représente en noir les valeurs à 0, en blanc les valeurs à 1, et en niveaux de gris les valeurs entre ces bornes. Or, on vérifie que abs(1) > 1 ne contient que des 1. En revance, avec l'option [ ], on rescale \(abs(f) \in [0, 1]\), avec la plus grande valeur en blanc, et la plus faible en noire. Or, la répartition des valeurs est très asymétrique, et on ne représente quasiment que du noir. On peut s'en convaincre en tracant le logarithme de cette image, qui donne la figure~\ref{7_33}.

\begin{figure}[H]
	\centering
	\begin{lstlisting}[frame=none, numbers = none]
	imshow(log(abs(f)),[]);
	\end{lstlisting}
	\includegraphics[height = 0.3\textheight]{7_33}
	\caption{Logarithme de la figure~\ref{7_22}}
	\label{7_33}
\end{figure}

En figure~\ref{7_3}, on sature \(1~\%\) des valeurs extremales du module de la transformée, et on redistribue linéairement les valeurs restantes sur tous les niveaux de gris. C'est ce que fait la fonction \textit{normsat}. La fonction \textit{fftshift} permet de centrer l'origine des fréquences, passant du coin supérieur gauche en figure~\ref{7_31} au centre en figure~\ref{7_32}.

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\begin{lstlisting}[frame = none, numbers = none]
		imshow(normsat(abs(f),1));
		\end{lstlisting}
		\includegraphics[scale = 1, height = 0.3\textheight]{7_31}
		\subcaption{Avec l'origine des fréquences en haut à gauche de l'image}
		\label{7_31}
	\end{subfigure}
	\vspace{2cm}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\begin{lstlisting}[frame=none, numbers = none]
		imshow(normsat(fftshift(abs(f)),1));
		\end{lstlisting}
		\includegraphics[scale = 1, height = 0.3\textheight]{7_32}
		\subcaption{Avec l'origine des fréquences au milieu de l'image}
		\label{7_32}
	\end{subfigure}
	\caption{Visualisation du module de la transformée de Fourier après saturation à \(1~\%\) des valeurs extremales et mapping linéaire des valeurs restantes en niveau de gris}
	\label{7_3}
\end{figure}

En figure~\ref{7_44} sont présentés les commandes et leur résultat pour visualier efficacement différentes parties d'une transformée de Fourier.

\begin{figure}
	\centering
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\begin{lstlisting}[frame = none, numbers = none]
imshow(log(1 +abs(real(fftshift(f)))), [])
		\end{lstlisting}
		\includegraphics[scale = 1, width = \textwidth]{7_41}
		\subcaption{Logarithme de la partie réelle}
		\label{7_41}
	\end{subfigure}
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\begin{lstlisting}[frame = none, numbers = none]
imshow(log(1 +abs(imag(fftshift(f)))), [])
		\end{lstlisting}
		\includegraphics[scale = 1, width = \textwidth]{7_42}
		\subcaption{Logarithme de la partie imaginaire}
		\label{7_42}
	\end{subfigure}
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\begin{lstlisting}[frame = none, numbers = none]
imshow(angle(fftshift(f)) + pi, [])
		\end{lstlisting}
		\includegraphics[scale = 1, width = \textwidth]{7_43}
		\subcaption{Phase}
		\label{7_43}
	\end{subfigure}
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\begin{lstlisting}[frame = none, numbers = none]
imshow(log(1 +abs(fftshift(f))), [])
		\end{lstlisting}
		\includegraphics[scale = 1, width = \textwidth]{7_44}
		\subcaption{Logarithme du module}
		\label{7_44}
	\end{subfigure}
	\caption{Visualisation des divers parties d'une transformée de Fourier}
	\label{}
\end{figure}

\clearpage

\section{Exercice 8}

\subsection{Question 1}

\begin{equation}
	\begin{split}
		U &= \sum_{0\le k \le M-1,~0 \le l \le N-1}u(k,l)\sum_{m,n\in \mathbb{Z}}\delta_{(k + mM, l + nN)}\\
		\widehat{U}(\bm{\xi}) &= \sum_{0\le k \le M-1,~0 \le l \le N-1}u(k,l) \int_{\mathbb{R}^2}\sum_{m,n\in \mathbb{Z}}\delta_{(k + mM, l + nN)}(x, y)e^{-ix\xi_x - iy\xi_y}dxdy \\
		\widehat{U}(\bm{\xi}) &= \sum_{0\le k \le M-1,~0 \le l \le N-1}u(k,l) \int_{\mathbb{R}^2}\sum_{m,n\in \mathbb{Z}}\delta_{(mM, nN)}(x - k, y - l)e^{-ix\xi_x - iy\xi_y}dxdy \\
		\widehat{U}(\bm{\xi}) &= \sum_{0\le k \le M-1,~0 \le l \le N-1}u(k,l) e^{-i(k\xi_x + l\xi_y)}\int_{\mathbb{R}^2}\sum_{m,n\in \mathbb{Z}}\delta_{(mM, nN)}(x, y)e^{-ix\xi_x - iy\xi_y}dxdy \\
		\widehat{U}(\bm{\xi}) &= \sum_{0\le k \le M-1,~0 \le l \le N-1}u(k,l) e^{-i(k\xi_x + l\xi_y)}\widehat{\Pi_{M, N}}(\bm{\xi}) \\
		\widehat{U}(\bm{\xi}) &= \sum_{0\le k \le M-1,~0 \le l \le N-1}u(k,l) e^{-i(k\xi_x + l\xi_y)}\frac{2\pi}{M}\frac{2\pi}{N}\Pi_{\frac{2\pi}{M}, \frac{2\pi}{N}}(\bm{\xi}) \\
		\widehat{U}(\bm{\xi}) &= \frac{2\pi}{M}\frac{2\pi}{N}\sum_{p,q\in \mathbb{Z}}\delta_{\frac{2\pi}{M}, \frac{2\pi}{N}}(\bm{\xi})\sum_{0\le k \le M-1,~0 \le l \le N-1}u(k,l) e^{-i(2\pi pk/M + 2\pi lq/N)}\\
		\widehat{U}(\bm{\xi}) &= \frac{2\pi}{M}\frac{2\pi}{N}\sum_{p,q\in \mathbb{Z}}\widehat{u}(p, q) \delta_{\frac{2\pi}{M}, \frac{2\pi}{N}}(\bm{\xi})\\
	\end{split}
	\label{eq_8_1}
\end{equation}

La relation étable en~\eqref{eq_8_1} montre que la tranformée de fourier discrète agit comme si le signal initial était déjà périodique, puisque les coefficients de Fourier sont ceux du signal périodisé.

\subsection{Question 2}

\begin{equation}
	\begin{split}
		\widehat{u}'(p, q) &= \sum_{k = 0}^{M - 1} \times \sum_{l = 0}^{N - 1}e^{-2i\pi p/M}e^{-2i\pi q/N}u'(k, l) \\
		&= \sum_{k = 0}^{M - 1} \times \sum_{l = 0}^{N - 1}e^{-2i\pi pk/M}e^{-2i\pi ql/N}u'(k, l)\\
		&= e^{-2i\pi p/M}e^{-2i\pi q/N}u'(k, l) \\
		&= e^{-2i\pi p/M}e^{-2i\pi ql_0/N}u'(k, l)
	\end{split}
	\label{eq_8_2}
\end{equation}


\section{Exercice 9}

L'interpolée de Shannon \(v(x,y)\) en fonction de \(\widehat{u}\) s'écrit :

\begin{equation}
	v(x,y) = \frac{1}{MN}\sum_{\mathclap{{|\alpha| \le M/2, |\beta| \le N/2, (p,q) \in \mathbb{Z}}}}\epsilon_M(\alpha)\epsilon_N(\beta)\widehat{u}(\alpha, \beta)  e^{2i\pi(\frac{\alpha x}{M} + \frac{\beta y}{N})}
\end{equation}

avec \(\epsilon_N(p) = 0.5\) si \(|p| = N/2\), donc dans le cas N pair, et 0 sinon

Montrons que :
\begin{equation}
	w(x,y) = \Re\left(\frac{1}{MN}\sum_{\substack{-M/2 \le \alpha < M/2\\ -N/2 \le \beta < N/2}} \widehat{u}(\alpha, \beta) e^{2i\pi(\frac{\alpha x}{M} + \frac{\beta y}{N})} \right)
\end{equation}
définit une interpolation exacte de \(u\).
En effet, on a, pour \((k,l) \in \mathbb{Z}\)

\begin{equation}
	\begin{split}
		w(k,l) &= \Re\left(\frac{1}{MN}\sum_{\substack{-M/2 \le \alpha < M/2\\ -N/2 \le \beta < N/2}}  \widehat{u}(\alpha, \beta) \exp\left(2i\pi(\frac{\alpha k}{M} + \frac{\beta l}{N})\right) \right) \\
		&= \Re\left(\frac{1}{MN}\sum_{\substack{-M/2 \le \alpha < M/2\\ -N/2 \le \beta < N/2}}  \left( \sum_{p, q = 0}^{M-1, N-1}u(p, q)\exp\left(-2i\pi(\frac{\alpha p}{M} + \frac{\beta q}{N})\right)\right) \exp\left(2i\pi(\frac{\alpha k}{M} + \frac{\beta l}{N})\right) \right)\\
		&= \Re\left(\frac{1}{MN} \sum_{p, q = 0}^{M-1, N-1}u(p, q) \left( \sum_{\substack{-M/2 \le \alpha < M/2\\ -N/2 \le \beta < N/2}} \exp\left(2i\pi(\alpha \frac{k - p}{M} + \beta\frac{l-q}{N})\right)\right)\right)\\
		&= \Re\left(\frac{1}{MN} \sum_{p, q = 0}^{M-1, N-1}u(p, q) M\delta(k-p)N\delta(l-q)\right)\\
		&= u(k,l)
	\end{split}
\end{equation}

\section{Exercice 10}

\subsection{Question 1}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.30\textheight]{10_1_11}
		\subcaption{Images initiales}
		\label{10_1_11}
	\end{subfigure}
	\vspace{2cm}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.30\textheight]{10_1_12}
		\subcaption{Images dont les phases ont été échangées}
		\label{10_1_12}
	\end{subfigure}
	\caption{Echange de phase entre \textit{room.pgm} et \textit{saturn.pgm}}
	\label{10_1}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.30\textheight]{10_1_21}
		\subcaption{Images initiales}
		\label{10_1_21}
	\end{subfigure}
	\vspace{2cm}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.30\textheight]{10_1_22}
		\subcaption{Images dont les phases ont été échangées}
		\label{10_1_22}
	\end{subfigure}
	\caption{Echange de phase entre \textit{room.pgm} et \textit{lena.pgm}}
	\label{10_2}
\end{figure}

Deux exemples sont présentés en figures~\ref{10_1}~\ref{10_2}. On constate que toute l'information n'est pas contenue uniquement dans le module de la transformée de Fourier, puisqu'on appercoit, avec le module de \textit{saturne} et la phase de \textit{room}, les rayures du coussin, ainsi que la forme de la bibliothèque. De la même façon, on apperçoit aussi lena dans l'image où on garde le module de \textit{room} et on ajoute la phase de \textit{lena}. En revanche, on semble conserver mieux les objets quand on garde le module de la transformée de Fourier.


\subsection{Question 2}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.30\textheight]{10_1_21}
		\subcaption{Images initiales}
		\label{10_1_21}
	\end{subfigure}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.30\textheight]{10_1_22}
		\subcaption{Images dont les phases ont été échangées}
		\label{10_1_22}
	\end{subfigure}
	\caption{Echange de phase entre \textit{room.pgm} et \textit{lena.pgm}}
	\label{10_2}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.20\textheight]{10_2_lena}
		\subcaption{A partir de \textit{lena}}
		\label{10_2_lena}
	\end{subfigure}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.20\textheight]{10_2_bulles}
		\subcaption{A partir de bulles de plastique}
		\label{10_2_bulles}
	\end{subfigure}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.20\textheight]{10_2_tissu}
		\subcaption{A partir d'un tissu avec des motifs en chevrons}
		\label{10_2_tissu}
	\end{subfigure}
	\begin{subfigure}[b]{\textwidth}
		\centering
		\includegraphics[height = 0.20\textheight]{10_2_noise}
		\subcaption{A partir de bruit blanc gaussien}
		\label{10_2_tissu}
	\end{subfigure}
	\caption{Synthèse de texture à partir de la composante périodique}
	\label{10_2_textures}
\end{figure}


\subsection{Question 3}


\end{document}
